****************************************
*              WARSHIPS                *
*         A game for Roona             *
****************************************
	ORG $2000

HOME	EQU $FC58
PRBYTE	EQU $FDDA
COUT	EQU $FDED
CROUT	EQU $FD8E
TEXT	EQU $FB2F
RDKEY	EQU $FD0C
VTAB	EQU $FC22

CH	EQU $24
CV	EQU $25

TOPLEFT	EQU $400

****************************************

Entry	JSR TEXT
	JSR HOME
	JSR PrCols
	LDX #0
	LDY #0
	JSR MvCursor
GameLoop	JSR DrwShips
	JSR Input
	JMP GameLoop

DrwShips	RTS

* PrCols prints the column names.
PrCols	LDX #0
PrCols1	LDA PrColsD,X
	BEQ PrCols2
	STA TOPLEFT,X
	INX
	JMP PrCols1
PrColsD	ASC " 12345678910"
	HEX 00
PrCols2	NOP

* PrRows prints the row names.
PrRows	LDX #0
PrRows1	LDA PrRowsD,X
	BEQ PrRows2,X
	JSR COUT
	JSR CROUT
	INX
	JMP PrRows1
PrRowsD	ASC " ABCDEFGHIJ"
	HEX 00
PrRows2	RTS

* MvCurosr moves the cursor to (X,Y)
MvCursor	STX CH
	STY CV
	INC CH
	INC CV
	JSR VTAB

Input	JSR RDKEY
	CMP #$9B
	BEQ Quit    ESC QUITS
	CMP #$88    LEFT ARROW
	BEQ Left
	CMP #$95    RIGHT ARROW
	BEQ Right
	CMP #$8A    DOWN ARROW
	BEQ Down
	CMP #$8B    UP ARROW
	BEQ Up
	CMP #$B0
	BCC Input1
	CMP #$BA
	BCS Input1  "1"-"9"
	CLC
	SBC #$AF    A-"0" + 1
	STA CH
	BNE Input2
	LDA #10
	STA CH
	JMP Input2
Input1	CMP #$C1
	BCC Input2
	CMP #$CB
	BCS Input2
	STA CV
	JSR VTAB
*	JSR PRBYTE
Input2	RTS

Left	DEC CH
	LDA CH
	BNE Left1
	INC CH      HIT LEFT EDGE
Left1	RTS

Right	INC CH
	LDA CH
	CMP #11
	BNE Right1
	DEC CH      HIT RIGHT EDGE
Right1	RTS

Up	DEC CV
	LDA CV
	BEQ Up1
	JSR VTAB
	RTS
Up1	INC CV
	RTS

Down	INC CV
	LDA CV
	CMP #11
	BEQ Down1
	JSR VTAB
	RTS
Down1	DEC CV
	RTS

Quit	JSR HOME
*	JSR Print
*	ASC "Thank you for playing!"
*	HEX 00
	JMP $3D0       RE-ENTER DOS

Ships	HEX 01010500   X,Y,LEN,SUNK
	HEX 02010400
	HEX 03010300
	HEX 04010300
	HEX 05010200

* vim: set noexpandtab tabstop=9 sts=9 sw=9 invlist textwidth=40 colorcolumn=40 filetype=asmMerlin65816:
